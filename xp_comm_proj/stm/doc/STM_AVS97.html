<HTML>
<HEAD>
	<!DOCTYPE HTML PUBLIC "html 4.0">
	<STYLE TYPE="text/css">
		 p {text-indent:0.5in; color:black}
		 caption {font-size:16pt; color:black;}
		#Special14 {
			color:brown; font-family:monospace; 
			font-style:italic; margin-left:4em; 
			margin-right:8em; text-align:justify; 
			font-size:10pt; padding-top:1em; 
			font-weight:bold;
		}
		#abstract {
			font-family:monospace; font-weight:bold;
			font-style:italic; margin-left:4em; 
			margin-right:8em; text-align:justify; 
			font-size:10pt; padding-top:1em; 
		}
		.NOTE {
			font-family:courier;
			color:green; 
			font-weight:bold; 
			font-size:10pt;
		}
		.BDR {
			border-style:ridge; 
			border-color:#ff0000; 
			border-width:9px; 
			background-color:yellow;
		}
	</STYLE>
	<META  HTTP-EQUIV="Keywords" CONTENT="Software">
	<META HTTP-EQUIV="Descriptions" CONTENT="STM Code">
	<TITLE>
		Viewing Gaussian(c) Cube Files 
		<BR>Using AVS Express
	</TITLE>
</HEAD>
<BODY LANG="EN" BGCOLOR="#f2fae4" BACKGROUND="bg1x.jpg">
<H1 ALIGN="center" CLASS="BDR">
	<SPAN STYLE="color:#800000; font-size:16pt;">
	Viewing Gaussian(c) Cube Files Using AVS and AVS Express
	</SPAN>
</H1>
<TABLE BORDER="0" ALIGN="center">
<TR> 
	<TD>Ken Flurchick</TD>
	<TD>&nbsp; and &nbsp;</TD>
	<TD>Libero Bartolotti</TD>
</TR><TR> 
	<TD>Ohio Supercomputer Center</TD>
	<TD>&nbsp;</TD>
	<TD>North Carolina Supercomputing Center</TD>
</TR><TR> 
	<TD>1224 Kinnear Rd </TD>
	<TD>&nbsp;</TD>
	<TD>3021 Cornwallis Rd</TD>
</TR><TR> 
	<TD>Columbus, OH 43212</TD>
	<TD>&nbsp;</TD>
	<TD>Research Triangle Park, NC 27709</TD>
</TR>
</TABLE>
<H1 ALIGN="center">Abstract</H1>
<P ID="abstract">
In this article we present two AVS/EXPRESS modules which read the geometric 
structure and electronic properties of a molecular system from the CUBE 
output generated by the GAUSSIAN(c) package[6].  These modules are, in part, 
extensions from previous work, namely the AVS5 modules <I>coord_to_geom</I> 
and <I>CUBE_to_Field</I>. Electronic and structural information is obtained 
from either Density Functional Theory or Schr&ouml;dinger Theory, using the 
GAUSSIAN(c) code.  These modules, in conjunction with the built-in 
visualization modules, can display the geometric structure with electronic 
properties.  In addition, using the enhanced User Interface capabilities in 
AVS/EXPRESS, a more user-friendly front-end has been developed.  The 
capabilities of these modules will be discussed using several examples from 
current research activities.
</P>
<H1 ALIGN="center">Introduction</H1>
<P>
Visualizing the results from quantum chemistry calculations is an important 
tool for scientists.  Several AVS5 modules[1] were written to process the 
data from a number of quantum chemistry programs and have been restructured 
to utilize the enhanced User Interface capabilities of AVS/EXPRESS plus the 
easier data structure to pass array objects to construct the field data.  
We call this set of modules the Simple Molecular Display (SMD).
</P>
<B>Quantum Mechanics Calculations</B>
<P>
The quantum chemistry packages calculate electron densities using either 
Density Functional Theory (DFT) via the Kohn-Sham (KS)[2] orbital-density 
equations:
<DIV ALIGN="center">
	<IMG SRC="Image2.gif">
	<BR><BR>
	<IMG SRC="Image1.gif">
</DIV>
where <FONT FACE="Symbol">C<SUB>k</SUB></FONT> is the basis function and  
the C<FONT FACE="Symbol"> &#107;</FONT> are the expansion coefficients or 
wave function functional theory via the Schr&omul;dinger equation;
<DIV ALIGN="center">
	<IMG SRC="Image3.gif">
</DIV>
where the Fock matrix <B>F<SUB><FONT FACE="Symbol">mn</B></SUB></FONT> is 
given by,
<DIV ALIGN="center">
	<IMG SRC="Image4.gif">
</DIV>
<P>where <FONT SIZE=4>D</FONT><SUB><FONT FACE="Symbol" SIZE=4>ls </SUB></FONT>
<FONT SIZE=4>= </FONT><FONT FACE="Symbol" SIZE=4>S</FONT>
<SUB><FONT SIZE=4>i</SUB> 
c<SUB>i</FONT><FONT FACE="Symbol" SIZE=4>l</SUB></FONT>
<FONT SIZE=4> c<SUB>i</FONT>
<FONT FACE="Symbol" SIZE=4>s</SUB></FONT><FONT SIZE=4> </FONT>
is the density matrix and <FONT SIZE=4>S</FONT>
<SUB><FONT FACE="Symbol" SIZE=4>mn</SUB></FONT> is the overlap 
matrix which arises from the non-orthogonality of the basis functions.
<P>
For additional information about the different methodologies, see Szabo Ostlundslund[3], Parr and Yang[4] and Boyd et.al.[5]. The electron density 
contains both quantitative and qualitative information about the system 
of interest.  Molecular properties can be determined from the electron 
density such as molecular bonding, reactivity indices, electrostatic 
potentials and aromatitcity.
<P>
The computational chemistry code GAUSSIAN is widely used by chemists, and 
can output a variety of molecular properties in addition to the molecular 
structure.  Some of the molecular properties are:
</P>
<OL>
	<LI>the <B>H</B>ighest <B>O</B>ccupied <B>M</B>olecular <B>O</B>rbital 
		(HOMO) determined by solving the Schr&ouml;dinger equation described 
		above
	<LI>the electronic charge density computed from the sum  of the squares 
		of the molecular orbitals namely,
		<DIV ALIGN="center">
			<IMG SRC="Image5.gif">
		</DIV>
		where N is the number of electrons in the molecule, n<SUB>i</SUB> 
		is the number of electrons in  the  i<SUP>th</SUP> molecular orbital 
	<LI>the electrostatic potential (ESP) which is written as,
		<DIV ALIGN="center">
			<IMG SRC="Image6.gif">
		</DIV>
		where, Z<SUB><FONT FACE="Symbol">a</SUB></FONT> is the nuclear 
		charge on the <FONT FACE="Symbol">a</FONT><SUP>th</SUP> nuclear 
		center in the molecule and <FONT FACE="Symbol">r</FONT>(<B>r</B>
		<SUB>1</SUB>) is the electron density
	<LI>the Laplacian of the density, whose zero-envelope defines a 
		reactivity surface[7]
</OL>
<H2 ALIGN="center">AVS/EXPRESS Modules</H2>
<P>
To display the molecular properties, the visualization process begins by 
reading the molecular structure and electronic property information and 
converting this information to AVS/EXPRESS objects.  This is accomplished 
by the AVS/EXPRESS module <I>mol_c</I> and <I>Read_G94_cube</I>.  Figure 1 
shows the subobjects in the modules <I>mol_c</I> and Figure 2 shows the 
subobjects of <I>Read_G94_cube</I>. 
</P>
<TABLE BORDER="0" ALIGN="center">
<TR>
	<TD VALIGN="top"> 
		Figure 1<BR>Subobject<BR>list for the<BR>module<BR> <I>mol_c</I>
	</TD>
	<TD ALIGN="center" VALIGN="top">
		<IMG ALT="Objects in mol_c" SRC="MolcObjects.gif">
	</TD>
	<TD>&nbsp;</TD>
	<TD VALIGN="top"> 
		Figure 2<BR>Subobject list<BR>for the module<BR><I>Read_G94_cube</I>
	</TD>
	<TD ALIGN="center" VALIGN="top">
		<IMG ALT="Objects in readCube" SRC="readCubeObjects.jpg">
	</TD>
</TR>
</TABLE>
<P>
One important point to note is that the module <I>mol_c</I> outputs arrays 
of numbers which represent the atomic centers (array a_lst), atom colors 
(array rgb_lst), atomic radii (array r_lst) and bonding information (array 
connect_lst).  The information is then passed to AVS/EXPRESS mesh modules. 
The module <I>Read_G94_cube</I> output both mesh coordinates array geometry) 
and the molecular property information (array Orbital_Data).
</P>
<P>
For the molecular structure, the modules point mesh (renamed as atomic point 
mesh), node color (renamed as atomic mesh color), node radii (renamed as 
atomic radii) and combine mesh (renamed as atomic field) are used (see 
figure 3) to create the molecular structure field. 
</P>
<TABLE ALIGN="center" BORDER="0">
<TR>
	<TD VALIGN="top">
		Figure 3<BR>Network to create<BR>molecular structure<BR>field.
	</TD>
	<TD VALIGN="top" ALIGN="right">
		<IMG ALT="Mol Display Net Level 2" SRC="MolNet2.jpg">
	</TD>
</TR>
</TABLE>
<P>
For the electronic structure (the ESP, HOMO and electron density), the 
modules <I>struct mesh</I> (structured mesh), nod<I>e scalar</I> (the 
molecular property data), and <I>combine mesh data</I> are used (see 
figure 4) to create the molecular property field.  The field data is the 
passed to the usual bounds, <I>isosurface</I> and <I>isoline</I> modules 
to display the data. 
</P>
<TABLE ALIGN="center" BORDER="0">
<TR>
	<TD VALIGN="top">
		Figure 4<BR>Network for the<BR>molecular property<BR>display.
	</TD><TD VALIGN="top" ALIGN="right">
		<IMG SRC="cubeNet.jpg">
	</TD>
</TR>
</TABLE>
<P>
In addition to the modules <I>mol_c</I> and <I>Read_G94_cube</I>, the user 
interface was designed using the interface modules (UI Kit). The UI kit 
contains numerous modules to manipulate windows, frames and widgets as part 
of the user interface.  The UI for the molecular structure part is shown in 
figure 5.  The parameters to select the type of file to read, the file name 
and the <B>units</B> parameters are options to select.  The display options 
are in the bottom part of the UI, the type of display, options to display 
atom names and so on.  The entire interface is constructed from modules 
built into AVS/EXPRESS, no additional coding was necessary.  The network to 
construct the UI is shown in figure 6.
</P>
<TABLE ALIGN="center" BORDER="0">
<TR>
	<TD VALIGN="top">
		Figure 5<BR>UI for<BR><I>mol_c</I>.
	</TD><TD VALIGN="top" ALIGN="center">
		<IMG ALT="Molecular Display UI" SRC="MolUI.jpg">
	</TD>
</TR><TR>
	<TD>&nbsp;</TD>
</TR><TR>
	<TD>&nbsp;</TD>
</TR><TR>
	<TD VALIGN="top">
		Figure 6<BR>Network to<BR>construct<BR>the <I>mol_c</I><BR>UI.
	</TD>
	<TD VALIGN="top" ALIGN="center">
		<IMG "Mol_c UI Network" SRC="UInet.jpg">
	</TD>
</TR>
</TABLE>
<H1 ALIGN="center">Results</H1>
<P>
To demonstrate the use of these modules, we show various displays of the 
molecular system tryptophan (C<SUB>11</SUB>H<SUB>12</SUB>N<SUB>2</SUB>O).  
The structure and molecular properties were computed using GAUSSIAN 94[6]. 
Figure 7 shows three views of the display, the most common type of display 
is shown, namely the geometry of the molecule.  Three different types of 
structure displays are shown.  The upper left is CPK, upper right is 
ball_and_stick and the bottom image shows the structure labeled by atom 
names. 
</P>
<TABLE ALIGN="center" BORDER="0">
<TR>
	<TD VALIGN="top">
		Figure 7<BR>Display of<BR>Tryptophan.
	</TD>
	<TD VALIGN="top" ALIGN="right">
		<IMG SRC="tryp_ann.jpg">
	</TD>
</TR>
</TABLE>
<P>
The next two figures show the capabilities of combining AVS and results 
from calculations.  Figure 8 shows the electron density plus the molecular 
structure and figure 9 depicts the HOMO and the molecular structure.
</P>
<TABLE ALIGN="center" BORDER="0">
<TR>
	<TD VALIGN="top">
		Figure 8<BR>Electronic<BR>shape of<BR>Tryptophan.
	</TD><TD VALIGN="top" ALIGN="right">
		<IMG SRC="tryp_den.jpg">
	</TD>
</TR><TR>
	<TD>&nbsp;</TD>
</TR><TR>
	<TD>&nbsp;</TD>
</TR><TR>
	<TD VALIGN="top">
		Figure 9<BR>HOMO<BR>display of<BR>Tryptophan.
	</TD><TD VALIGN="top" ALIGN="center">
		<IMG SRC="tryp_homo.jpg">
	</TD>
</TR>
</TABLE>
<P>
Lastly, we show in figure 10, some contour lines of the electrostatic 
potential.  Also in the image, is the 3D viewer used to display the results 
in AVS/EXPRESS.
</P>
<TABLE ALIGN="center" BORDER="0">
<TR>
	<TD VALIGN="top">
		Figure 10<BR>Electrostatic<BR>potential contours
		<BR>of Tryptophan.
	</TD>
	<TD VALIGN="top" ALIGN="right">
		<IMG SRC="tryp_pot.jpg">
	</TD>
<TR>
</TABLE>

<H1 ALIGN="center">
	References
</H1>
<OL>
	<LI>K.M. Flurchick and Lee Bartolotti, 
			"Visualizing Properties of Atomic and Molecular Systems", 
			Journal of Molecular Graphics, 13, 10, (1995). And K. Flurchick, 
			Lee Bartolotti and Mark Reed, 
			"Visualizing Properties of Atomic and Molecular Systems in AVS", 
			AVS'94 Proceedings.
	<LI>W. Kohn and L.J. Sham, Phys. Rev. 140, A1133 (1965)
	<LI>Modern Quantum Chemistry, Atilla Szabo and Neil Ostlund, MacMillan 
			Publishing Co. N.Y. 1982
	<LI>W.G. Parr and W. Yang, Density-Functional Theory of Atoms and 
			Molecules Oxford University Press, New York, 1989
	<LI>Reviews in Computational Chemistry, Kenny B. Lipkowitz and Donald B. 
			Boyd, eds. VCH, New York 1992
	<LI>Gaussian 94, Revision E.1, M. J. Frisch, G. W. Trucks, H. B. Schlegel, 
			P. M. W. Gill,B. G. Johnson, M. A. Robb, J. R. Cheeseman, T. Keith,G. 
			A. Petersson, J. A. Montgomery, K. Raghavachari, M. A. Al-Laham, 
			V. G. Zakrzewski, J. V. Ortiz, J. B. Foresman, J. Cioslowski, 
			B. B. Stefanov, A. Nanayakkara, M. Challacombe, C. Y. Peng, 
			P. Y. Ayala, W. Chen, M. W. Wong, J. L. Andres, E. S. Replogle, 
			R. Gomperts, R. L. Martin, D. J. Fox, J. S. Binkley, D. J. Defrees, 
			J. Baker, J. P. Stewart, M. Head-Gordon, C. Gonzalez, and J. A. Pople, 
			Gaussian, Inc., Pittsburgh PA, 1995.
	<LI>Atoms in Molecules: A Quantum Theory, R.F.W. Bader, Claredon Press, 
			Oxford 1994.
</OL>
</BODY>
</HTML>
