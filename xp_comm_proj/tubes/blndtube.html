<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>BlendyTubesCore</title>
</head>
<body bgcolor="#92bfbf">

<h1>BlendyTubesCore</h1>

<h3>Synopsis</h3>

<blockquote>
Convert polylines to continuous tubes using scalar data to scale and colour the generated tubes.
</blockquote>

<blockquote>
<hr><pre>
  module BlendyTubesCore &lt;src_file="blendytubes.cxx",
                          libdeps="FLD",
                          cxx_hdr_files="fld/Xfld.h"&gt;
  {
    Mesh+Node_Data+read+notify+req+IPort2 &amp;lines_in;

    TubesParams+IPort2 &amp;params;

    float+read+notify+req scale         =&gt; .params.scale;
    boolean+read+notify+req offsetScale =&gt; .params.offsetScale;
    boolean+read+notify+req invertScale =&gt; .params.invertScale;
    int+read+notify+req facets          =&gt; .params.facets;

    cxxmethod+notify_inst+req update;

    Mesh+Node_Data+write+OPort2 tubes_out;
  };
</pre><hr>
</blockquote>

<h3>Description</h3>

<blockquote>
<p>This module takes a Polyline cell_set with at least one scalar node_data component and creates a continuous tube for each polyline.  For each node in the polyline a circular cross section is created and oriented in the direction of the polyline at that node.  If two node_data components are present the second node_data component is used to proportionally scale each circular cross section.  The <i>scale</i> parameters allows control over the overall width of the tube. The first node_data component is mapped appropriately to each node of the cross section.  This results in colour mapped tubes that optionally vary in width according to the two separate node data components.</p>

<p>The module is designed to be used in conjunction with the DVinterp_data module to generate the node_data at each node of the polylines.  The <i>Tubes</i> user macro does this.  It is expected that the input polyline mesh will be generated by the Streamlines module, however other sources of polylines can be used.  For instance the isoline module generates data with a Line cell set.  By using the <i>Isoline2Polyline</i> module the data output by the isoline module can be used as the input to BlendyTubesCore module.  An example of doing this is provided with the <i>Isoline2Polyline</i> project.</p>
</blockquote>


<h3>Inputs</h3>

<blockquote>
<i><b>&amp;lines_in</b></i>
</blockquote>

<blockquote>
Input field data that contains a mesh with a cell_set of Polyline type and at least one scalar node_data components.  The first node data component will be used to colour map the tube sections.  If a second node data component is present it will be used to scale each section.  Any other node data components will be ignored.  The node_data can be of any <b>scalar</b> data type.
</blockquote>

<blockquote>
<i><b>&amp;TubesParams</b></i>
</blockquote>

<blockquote>
A reference to the parameter block that contains the actual values of the module parameters.
</blockquote>

<blockquote>
<i><b>scale</b></i>
</blockquote>

<blockquote>
An overall scaling value that will be applied to each section of the tube.  This parameter is always used and is not dependent upon whether scaling node data is present or not.
</blockquote>

<blockquote>
<i><b>offsetScale</b></i>
</blockquote>

<blockquote>
If the scaling node data component contains negative values and offsetScale is <I>true</I> then the scaling values will be shifted so they are all positive starting from zero. If offsetScale is <i>false</i> negative values will cause the tubes to turn themselves 'inside-out'.  This parameter is ignored if no scaling node data is present.
</blockquote>

<blockquote>
<i><b>invertScale</b></i>
</blockquote>

<blockquote>
If invertScale is <I>true</I> then the scale component values will be inverted, hence larger values will produce narrower tubes and versa-versa. The <I>scale</I> parameter will still work as before as this overall scaling is applied after the data component scaling.  This parameter is ignored if no scaling node data is present.
</blockquote>

<blockquote>
<i><b>facets</b></i>
</blockquote>

<blockquote>
The number of sides each tube will have.  This parameter cannot be less than 3.
</blockquote>


<h3>Outputs</h3>

<blockquote>
<i><b>tubes_out</b></i>
</blockquote>

<blockquote>
The generated field data containing a Mesh with Quad cell_set that forms the tubes and one scalar node data component that should be used for colour mapping the tubes.
</blockquote>


<h3>Utility Macros</h3>

<blockquote>
	The low-level BlendyTubesCore module is used in the TubesFunc functional macro. This macro is in turn used by the Tubes user macro.
</blockquote>


<h3>Example</h3>

<blockquote>
	Two example applications are provided for this project. The BlendyTubesEg application reads the <i>'bluntfin</i> data set and generates a series of streamlines to visualize the air flow.  The tubes macro is then used to generate a series of colour and size mapped tubes around each streamline.  The SimpleTubesEg application similarly read the <i>'bluntfin</i> data set.  However it only generates a series of colour mapped tubes around each streamline.
</blockquote>


<h3>Files</h3>

<blockquote>
<p><i>xp_comm_proj/tubes/tubesmods.v</i> contains the V definitions of the BlendyTubesCore low-level module and the TubesParams parameter block.</p>

<p><i>xp_comm_proj/tubes/tubesmacs.v</i> contains the V definitions of the TubesUI user interface macros, the TubesFunc functional macro, the Tubes user macro and the example applications.</p>
</blockquote>


<h3>Other Notes</h3>

<blockquote>
<p>It is realised that the cross section of the tubes should be elliptical.  However this would require further rotations to be carried out to orientate it correctly.  The major use of the module is likely to be with Streamlines.  As these tend to be 'smoothy' curved with short line segments it was decided that a circular cross section would be a sufficient approximation.</p>

<p>The low-level BlendyTubesMods library containing the module BlendyTubesCore does not specify a process. By default the express process will be used.</p>
</blockquote>


<h3>Author</h3>

<blockquote><pre>
James S. Perrin : <A HREF="mailto:james.perrin@man.ac.uk">james.perrin@man.ac.uk</A>,
Manchester Visualization Centre
</pre></blockquote>

<h3>Modifications</h3>

<blockquote><pre>
Ian Curington,
AVS Inc.

<a href="mailto:andrew.dodd@man.ac.uk">Andrew Dodd</a>,
International AVS Centre
</pre></blockquote>

<blockquote><pre>
Robert Frank
Manchester Visualization Centre
</pre></blockquote>

<h3>See Also</h3>

<ul>
<li><a href="../iso2poly/iso2poly.html">Isoline2Polyline</a> IAC project.</li>
<li>DVinterp_data AVS/Express module.</li>
<li>streamlines AVS/Express module.</li>
<li>isoline AVS/Express module.</li>
</ul>

</body>
</html>

