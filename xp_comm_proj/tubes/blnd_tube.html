<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>blendy_tubes</title>
</head>
<body bgcolor="#92bfbf">

<h1>blendy_tubes</h1>

<h3>Synopsis</h3>

<blockquote>
Convert polylines to continuous tubes using interpolated scalar data to scale and colour the tubes.
</blockquote>

<blockquote>
<h4>Input Ports</h4>

<table summary="Input Ports used by blendy_tubes">

<tr>
<td width="125"><font size="-1"><b>Name</b></font></td>
<td width="125"><font size="-1"><b>Type</b></font></td>
<td width="300"><font size="-1"><b>Description</b></font></td>
</tr>

<tr>
<td colspan="4"><hr></td>
</tr>

<tr>
<td width="125"><i>lines</i></td>
<td width="125">Mesh</td>
<td width="300">Polyline cell_set</td>
</tr>

<tr>
<td width="125"><i>data</i></td>
<td width="125">Mesh+Node_Data</td>
<td width="300">Data used for interpolation</td>
</tr>

<tr>
<td colspan="4"><hr></td>
</tr>
</table>


<h4>Parameters</h4>

<table summary="Parameters used by blendy_tubes">

<tr>
<td width="125"><font size="-1"><b>Name</b></font></td>
<td width="125"><font size="-1"><b>Type</b></font></td>
<td width="300"><font size="-1"><b>Description</b></font></td>
<td width="100"><font size="-1"><b>UI Control</b></font></td>
</tr>
<tr>
<td colspan="4"><hr></td>
</tr>

<tr>
<td width="125"><i>facets</i></td>
<td width="125">int</td>
<td width="300">Number of sides the tubes have.</td>
<td width="100">Slider</td>
</tr>

<tr>
<td width="125"><i>scale</i></td>
<td width="125">float</td>
<td width="300">Overall scaling of tubes.</td>
<td width="100">Slider</td>
</tr>

<tr>
<td width="125"><i>offsetScale</i></td>
<td width="125">boolean</td>
<td width="300">Offset scaling values of tubes.</td>
<td width="100">Toggle</td>
</tr>

<tr>
<td width="125"><i>invertScale</i></td>
<td width="125">boolean</td>
<td width="300">Invert scaling of tubes.</td>
<td width="100">Toggle</td>
</tr>

<tr>
<td width="125"><i>Colour Component</i></td>
<td width="125">int</td>
<td width="300">Node_Data component to use for tube colour</td>
<td width="100">Radio Box</td>
</tr>

<tr>
<td width="125"><i>Scale Component</i></td>
<td width="125">int</td>
<td width="300">Node_Data component to use for tube scaling</td>
<td width="100">Radio Box</td>
</tr>

<tr>
<td colspan="4"><hr></td>
</tr>
</table>

<h4>Output Ports</h4>

<table summary="Output Ports used by blendy_tubes">

<tr>
<td width="125"><font size="-1"><b>Name</b></font></td>
<td width="125"><font size="-1"><b>Type</b></font></td>
<td width="300"><font size="-1"><b>Description</b></font></td>
</tr>

<tr>
<td colspan="4"><hr></td>
</tr>

<tr>
<td width="125"><i>out_fld</i></td>
<td width="125">Mesh+Node_Data</td>
<td width="300">Tubes with one scalar node_data component.</td>
</tr>

<tr>
<td width="125"><i>out_obj</i></td>
<td width="125">GDobject</td>
<td width="300">Directly renderable output object.</td>
</tr>

<tr>
<td colspan="4"><hr></td>
</tr>
</table>
</blockquote>



<h3>Description</h3>

<blockquote>
<p>This macro takes a Polyline Mesh and a Field with at least one node_data component and creates a continuous tube for each polyline. For each node in the polyline a circular cross section is created with is scaled using the <i>Scale Component</i> node data and oriented in the direction of the polyline at that node. The scale parameters allow control over the overall width of the tube. The <i>Colour Component</i> node data is mapped appropriately to each node of the cross section. This results in colour mapped tubes that vary in width according to two separate node data components.</p>

<p>Internally the macro uses the DVinterp_data module to apply the node data from the data field to the Polyline mesh.  This combined Polyline field is then processed by the low-level <a href="doc_mod.html">BlendyTubesCore</a> module to generate the output tubes.  Internally the macro also automatically scales the data to the dimensions of the Mesh.  This ensures the generated tubes always appear at a sensible scale even when the user switches between data-sets with widely differing ranges.</p>

<p>It is expected that the input polyline mesh will be generated by the Streamlines module, however other sources of data can be used.  For instance the isoline module generates data with a Line cell set.  By using the <a href="..\iso2poly\iso2poly.html">Isoline2Polyline</a> module the output of the isoline module can be used as the input to blendy_tubes macro.  An example of doing this is provided with the <a href="..\iso2poly\iso2poly.html">Isoline2Polyline</a> project.</p>
</blockquote>


<h3>Input Ports</h3>

<blockquote>
<i><b>lines</b></i>
</blockquote>

<blockquote>
Input Mesh that should contain a cell_set of type Polyline.  This mesh should describe the path that you wish the generated tubes to take.
</blockquote>

<blockquote>
<i><b>data</b></i>
</blockquote>

<blockquote>
Input Field that should have at least one scalar node_data component. The data will be interpolated so that it matches the nodes of the polylines and then used for scaling and colour mapping.  Normally this input will be connected to the original data before it has being processed by visualization modules.  Alternatively if the <i>lines</i> input also has node data that input can be connected to provide node data.
</blockquote>


<h3>Parameters</h3>

<blockquote>
<i><b>facets</b></i>
</blockquote>

<blockquote>
Number of sides the tubes will have.  The generated tubes require at least 3 facets.
</blockquote>

<blockquote>
<i><b>scale</b></i>
</blockquote>

<blockquote>
An overall scaling factor to control the width of the tubes.  It should be noted that the scaling factor that is set in the User Interface is processed before being given to the BlendyTubesCore module.  This allows the blendy_tubes macro to automatically scale the input node data so that the generated tubes are of a consistent size.
</blockquote>

<blockquote>
<i><b>offsetScale</b></i>
</blockquote>

<blockquote>
If the scale node data component contains negative values and Offset Scale is on the scaling values will be shifted so they are all positive and therefore all start from zero.  If Offset Scale is off negative values will cause the tubes to turn themselves 'inside-out'.
</blockquote>

<blockquote>
<i><b>Invert Scale</b></i>
</blockquote>

<blockquote>
If Invert Scale is on then the scale node data component values will be inverted, hence larger values will produce narrower tubes and versa-versa. The <I>scale</I> parameter will still work as before as this overall scaling is applied after the data component scaling.
</blockquote>

<blockquote>
<i><b>Scale Component</b></i>
</blockquote>

<blockquote>
Specifies which of the components of <i>node data</i> should be used to size each section of the tube.
</blockquote>

<blockquote>
<i><b>Colour Component</b></i>
</blockquote>

<blockquote>
Specifies which of the components of <i>node data</i> should be used to colour map each section of the tube.
</blockquote>


<h3>Output Ports</h3>

<blockquote>
<i><b>out_fld</b></i>
</blockquote>

<blockquote>
Output field containing a Mesh with a Quad cell_set that forms the generated tubes and one scalar node data component that is used for colour mapping the tubes.
</blockquote>

<blockquote>
<i><b>out_obj</b></i>
</blockquote>

<blockquote>
The GDobject version of the field output, suitable for direct connection
to a viewer.
</blockquote>


<h3>Utility Macros</h3>

<blockquote>
The BlendyTubesFunc functional macro uses the low-level BlendyTubesCore module.  The blendy_tubes user macro uses this functional macro and the BlendyTubesUI user interface macro.  The simple_tubes user macro also uses this functional macro and the SimpleTubesUI user interface macro.  The BlendyTubesParams parameter block is used to transfer data between each of these macros.
</blockquote>


<h3>Example</h3>

<blockquote>
Two example applications are provided with this project.  The BlendyTubesEg application reads the <i>'bluntfin</i> data set and generates a series of streamlines to visualize the air flow.  The blendy_tubes macro is then used to generate a series of colour and size mapped tubes around each streamline.  The SimpleTubesEg application similarly read the <i>'bluntfin</i> data set.  However it only generates a series of colour mapped tubes around each streamline.
</blockquote>


<h3>Files</h3>

<blockquote>
<p><i>xp_comm_proj/blndtube/blndmods.v</i> contains the V definitions of the BlendyTubesCore low-level module and the BlendyTubesParams parameter block.</p>

<p><i>xp_comm_proj/blndtube/blndmacs.v</i> contains the V definitions of the SimpleTubesUI and BlendyTubesUI user interface macros, the BlendyTubesFunc functional macro and the simple_tubes and blendy_tubes user macros.</p>

<p><i>xp_comm_proj/blndtube/blndapps.v</i> contains the V definition of the SimpleTubesEg and BlendyTubesEg example applications.</p>
</blockquote>


<h3>Other Notes</h3>

<blockquote>
<p>It is realised that the cross section of the tubes should be elliptical.  However this would require further rotations to be carried out to orientate it correctly.  The major use of the module is likely to be with Streamlines.  As these tend to be 'smoothy' curved with short line segments it was decided that a circular cross section would be a sufficient approximation.</p>

<p>The BlendyTubesMacs library inherits its process. As this library contains no procedural code, the process is not important. The modules in the low-level BlendyTubesMods library execute under the process specified in that library, not the process defined in the high-level library.</p>
</blockquote>


<h3>Author</h3>

<blockquote><pre>
James S. Perrin : <A HREF="mailto:james.perrin@man.ac.uk">james.perrin@man.ac.uk</A>,
Manchester Visualization Centre
</pre></blockquote>

<h3>Modifications</h3>

<blockquote><pre>
Ian Curington,
AVS Inc.

<a href="andrew.dodd@man.ac.uk">Andrew Dodd</a>,
International AVS Centre
</pre></blockquote>

<h3>See Also</h3>

<ul>
<li><a href="doc_mod.html">BlendyTubesCore</a> low-level module.</li>
<li><a href="smp_tube.html">simple_tubes</a> user macro.</li>
<li><a href="..\iso2poly\iso2poly.html">Isoline2Polyline</a> IAC project.</li>
<li>DVinterp_data AVS/Express module.</li>
<li>streamlines AVS/Express module.</li>
<li>isoline AVS/Express module.</li>
</ul>

</body>
</html>

